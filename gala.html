<!DOCTYPE html>
<html lang="es" class="h-full w-full overflow-hidden bg-[#050505]">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GALA EN DIRECTO | VIAJE DE S3X0 AWARDS</title>
    
    <!-- FAVICON -->
    <link rel="icon" type="image/png" href="fotos/logo.png" />

    <!-- FUENTES -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700;900&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <!-- LIBRERÍAS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <!-- CONFIGURACIÓN TAILWIND -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              gold: { DEFAULT: '#d4af37', light: '#fedc56', dark: '#aa771c' },
            },
            fontFamily: {
              sans: ['Montserrat', 'sans-serif'],
              display: ['Playfair Display', 'serif'],
            },
            animation: {
                'shake-hard': 'shake-hard 0.5s cubic-bezier(.36,.07,.19,.97) both infinite',
                'float': 'float 6s ease-in-out infinite',
            },
            keyframes: {
                'shake-hard': {
                    '0%, 100%': { transform: 'translate3d(0, 0, 0) rotate(0deg)' },
                    '10%, 30%, 50%, 70%, 90%': { transform: 'translate3d(-2px, 2px, 0) rotate(-1deg)' },
                    '20%, 40%, 60%, 80%': { transform: 'translate3d(2px, -2px, 0) rotate(1deg)' }
                },
                float: { '0%, 100%': { transform: 'translateY(0)' }, '50%': { transform: 'translateY(-10px)' } }
            }
          }
        }
      }
    </script>

    <style>
        /* CURSOR */
        body { cursor: none; }
        #custom-cursor {
            position: fixed; top: 0; left: 0; width: 20px; height: 20px;
            border: 1px solid #d4af37; background-color: rgba(212, 175, 55, 0.2); 
            border-radius: 50%; pointer-events: none; z-index: 9999;
            transform: translate(-50%, -50%); transition: transform 0.1s ease, width 0.3s, height 0.3s;
        }
        #custom-cursor.hovered { width: 50px; height: 50px; background-color: rgba(212, 175, 55, 0.2); border-color: #fedc56; }
        #cursor-dot {
            position: fixed; top: 0; left: 0; width: 4px; height: 4px;
            background-color: #d4af37; border-radius: 50%; pointer-events: none; z-index: 10000;
            transform: translate(-50%, -50%);
        }

        /* TARJETA 3D */
        .perspective-container { perspective: 2000px; }
        .card-flip { 
            position: relative; width: 100%; height: 100%; 
            transition: transform 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55); 
            transform-style: preserve-3d; 
        }
        .card-flip.flipped { transform: rotateY(180deg); }
        .front, .back { 
            position: absolute; inset: 0; 
            -webkit-backface-visibility: hidden; backface-visibility: hidden; 
            border-radius: 1.5rem;
            box-shadow: 0 40px 80px -20px rgba(0, 0, 0, 0.8);
        }
        /* Ajuste para que el sello no se corte: overflow visible en front si es necesario, pero border radius requiere hidden */
        /* Solución: Padding interno suficiente en el contenedor flex */
        .front { overflow: hidden; } 
        .back { transform: rotateY(180deg); background: #121212; overflow: hidden; }

        /* SELLO DE LACRE */
        .wax-seal {
            background: radial-gradient(circle at 30% 30%, #e63946, #9d0208);
            box-shadow: 0 6px 15px rgba(0,0,0,0.7), inset 0 -4px 10px rgba(0,0,0,0.5);
            border: 3px solid #6a040f;
        }
        
        .winner-text-gradient {
            background: linear-gradient(to bottom, #ffffff 0%, #d4af37 60%, #aa771c 100%);
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
    </style>
</head>
<body class="bg-black text-white h-screen w-screen flex flex-col relative selection:bg-gold selection:text-black overflow-hidden">

    <!-- CURSOR -->
    <div id="custom-cursor"></div>
    <div id="cursor-dot"></div>

    <!-- AUDIO -->
    <audio id="audio-drumroll" src="fotos/redoble.mp3" preload="auto"></audio>
    <audio id="audio-victory" src="fotos/victoria.mp3" preload="auto"></audio>

    <!-- FONDO -->
    <canvas id="constellation-bg" class="fixed inset-0 pointer-events-none z-0"></canvas>
    <div class="fixed inset-0 pointer-events-none z-0 bg-[radial-gradient(circle_at_center,transparent_0%,#000000_100%)] opacity-80"></div>

    <!-- CABECERA (LOGO) - Z-INDEX ALTO -->
    <div class="absolute top-0 left-0 p-8 z-40">
        <div class="flex items-center gap-4 group">
            <img src="fotos/logo.png" class="w-16 h-16 md:w-20 md:h-20 object-contain drop-shadow-[0_0_20px_rgba(212,175,55,0.4)] group-hover:scale-110 transition-transform duration-500">
            <div class="hidden md:block">
                <p class="text-gold/80 text-[10px] tracking-[0.4em] uppercase font-bold mb-1">Gala Oficial</p>
                <h1 class="text-white font-display text-xl tracking-widest font-bold">VIAJE DE S3X0 <span class="text-gold">AWARDS</span></h1>
            </div>
        </div>
    </div>

    <!-- CONTADOR (ESQUINA INFERIOR IZQUIERDA) -->
    <div class="absolute bottom-8 left-8 z-40">
        <div class="inline-flex items-center gap-3 bg-black/60 backdrop-blur-xl px-6 py-3 rounded-full border border-gold/30 shadow-[0_0_20px_rgba(0,0,0,0.7)] hover:border-gold/60 transition-colors">
            <span class="text-[10px] text-neutral-400 uppercase tracking-[0.2em]">Categoría</span>
            <span id="counter" class="text-gold font-mono text-2xl font-bold">1 / 15</span>
        </div>
    </div>

    <!-- ESCENARIO CENTRAL -->
    <main class="relative z-10 flex-1 flex flex-col items-center justify-center w-full h-full px-6">
        
        <!-- Título de Categoría (Separado del logo con mt-24 o más) -->
        <div class="w-full max-w-7xl text-center mb-6 md:mb-10 relative z-20 mt-24 md:mt-16">
            <h2 id="category-title" class="text-2xl md:text-5xl lg:text-6xl font-display font-bold uppercase tracking-wide text-transparent bg-clip-text bg-gradient-to-b from-white via-white to-gold/40 drop-shadow-2xl transition-all duration-700 leading-tight px-4">
                Cargando...
            </h2>
        </div>

        <!-- EL SOBRE GIGANTE (Aumentado tamaño) -->
        <div class="perspective-container w-full max-w-[500px] md:max-w-[750px] aspect-[4/5] md:aspect-[16/10] relative z-10 mb-8">
            <div id="main-card" class="card-flip cursor-pointer group" onclick="startRevealSequence()">
                
                <!-- FRENTE: SOBRE CERRADO -->
                <div id="card-front" class="front bg-[#0e0e0e] border border-gold/30 flex flex-col items-center justify-center relative transition-all duration-300 group-hover:border-gold/60 group-hover:shadow-[0_0_60px_rgba(212,175,55,0.25)]">
                    
                    <!-- Textura Fondo -->
                    <div class="absolute inset-0 opacity-20 bg-[url('https://www.transparenttextures.com/patterns/black-scales.png')]"></div>
                    <div class="absolute inset-0 bg-gradient-to-br from-white/5 via-transparent to-black/80"></div>
                    
                    <!-- Líneas decorativas del sobre -->
                    <div class="absolute top-0 left-0 w-full h-full pointer-events-none opacity-10">
                        <svg width="100%" height="100%" viewBox="0 0 100 100" preserveAspectRatio="none">
                            <line x1="0" y1="0" x2="50" y2="50" stroke="white" stroke-width="0.3" />
                            <line x1="100" y1="0" x2="50" y2="50" stroke="white" stroke-width="0.3" />
                            <line x1="0" y1="100" x2="50" y2="50" stroke="white" stroke-width="0.3" />
                            <line x1="100" y1="100" x2="50" y2="50" stroke="white" stroke-width="0.3" />
                        </svg>
                    </div>

                    <!-- SELLO DE LACRE (Más espacio alrededor) -->
                    <div class="relative z-20 animate-float transform scale-110 mb-8 p-4">
                        <div class="wax-seal w-32 h-32 md:w-40 md:h-40 rounded-full flex items-center justify-center relative shadow-2xl">
                            <!-- Relieve del sello -->
                            <div class="absolute inset-2 border-2 border-[#590d22] rounded-full opacity-40"></div>
                            <i data-lucide="crown" class="w-16 h-16 text-[#590d22] drop-shadow-lg transform rotate-[-5deg]"></i>
                        </div>
                    </div>

                    <div class="text-center relative z-20 px-6">
                        <p class="text-gold font-display text-3xl md:text-5xl uppercase tracking-[0.2em] drop-shadow-lg">Confidencial</p>
                        <div class="mt-4 inline-block border border-neutral-700 px-4 py-1 rounded-full bg-black/50 backdrop-blur">
                            <p class="text-neutral-400 text-[10px] md:text-xs tracking-[0.4em] uppercase font-bold group-hover:text-white transition-colors">Tocar para romper sello</p>
                        </div>
                    </div>
                </div>

                <!-- DORSO: RESULTADO -->
                <div class="back flex flex-col relative border-2 border-gold shadow-[0_0_150px_rgba(212,175,55,0.3)] bg-black">
                    
                    <!-- IMAGEN/VIDEO (Ocupa casi todo para impacto visual) -->
                    <div class="relative w-full flex-grow bg-black overflow-hidden">
                        <!-- Imagen ajustada con object-contain o cover según preferencia. Cover rellena todo -->
                        <img id="winner-img" src="" class="absolute inset-0 w-full h-full object-cover hidden transition-transform duration-[20s] hover:scale-105">
                        <video id="winner-video" src="" class="absolute inset-0 w-full h-full object-cover hidden" loop muted playsinline></video>
                        <!-- Gradiente sutil inferior para texto -->
                        <div class="absolute bottom-0 w-full h-1/2 bg-gradient-to-t from-black via-black/60 to-transparent"></div>
                    </div>

                    <!-- INFO GANADOR -->
                    <div class="relative w-full h-auto min-h-[140px] flex flex-col justify-end p-6 md:p-10 text-center bg-black border-t border-white/10 z-10">
                        <div class="absolute -top-6 left-1/2 -translate-x-1/2">
                            <span class="bg-gold text-black text-[10px] md:text-xs font-bold px-6 py-2 rounded-full uppercase tracking-widest shadow-[0_0_20px_#d4af37] animate-pulse">Ganador Oficial</span>
                        </div>
                        
                        <h3 id="winner-name" class="text-3xl md:text-5xl lg:text-6xl font-display font-bold uppercase mb-2 leading-none winner-text-gradient drop-shadow-lg break-words">
                            <!-- Nombre aquí -->
                        </h3>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <!-- NAVEGACIÓN (ESQUINA INFERIOR DERECHA) -->
    <div class="absolute bottom-8 right-8 z-40 flex items-center gap-4">
        
        <!-- Botón Anterior -->
        <button id="btn-prev" onclick="changeCategory(-1)" class="opacity-0 pointer-events-none group flex items-center justify-center w-14 h-14 rounded-full border border-neutral-700 hover:border-white text-neutral-500 hover:text-white transition-all duration-300 hover:bg-white/5 backdrop-blur-md">
            <i data-lucide="arrow-left" class="w-6 h-6"></i>
        </button>

        <!-- Botón Siguiente -->
        <button id="btn-next" onclick="changeCategory(1)" class="opacity-0 pointer-events-none transform translate-y-10 transition-all duration-500 flex items-center gap-4 bg-white text-black pl-8 pr-3 py-3 rounded-full font-bold uppercase text-sm tracking-widest hover:bg-gold hover:scale-105 shadow-[0_0_30px_rgba(255,255,255,0.2)]">
            <span>Siguiente</span>
            <div class="p-2 rounded-full bg-black text-white">
                <i data-lucide="arrow-right" class="w-5 h-5"></i>
            </div>
        </button>
    </div>

    <!-- LOGICA -->
    <script>
        lucide.createIcons();

        // --- CURSOR ---
        const cursor = document.getElementById('custom-cursor');
        const cursorDot = document.getElementById('cursor-dot');
        document.addEventListener('mousemove', (e) => {
            cursorDot.style.left = e.clientX + 'px';
            cursorDot.style.top = e.clientY + 'px';
            setTimeout(() => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';
            }, 50);
        });
        document.querySelectorAll('button, .group').forEach(el => {
            el.addEventListener('mouseenter', () => cursor.classList.add('hovered'));
            el.addEventListener('mouseleave', () => cursor.classList.remove('hovered'));
        });

        // --- FONDO ---
        const canvas = document.getElementById('constellation-bg');
        const ctx = canvas.getContext('2d');
        let particlesArray;
        
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; initParticles(); }
        window.addEventListener('resize', resizeCanvas);

        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.directionX = (Math.random() * 0.2) - 0.1; this.directionY = (Math.random() * 0.2) - 0.1;
                this.size = Math.random() * 2; this.color = '#d4af37';
            }
            draw() { ctx.beginPath(); ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false); ctx.fillStyle = this.color; ctx.fill(); }
            update() {
                if (this.x > canvas.width || this.x < 0) this.directionX = -this.directionX;
                if (this.y > canvas.height || this.y < 0) this.directionY = -this.directionY;
                this.x += this.directionX; this.y += this.directionY; this.draw();
            }
        }
        function initParticles() {
            particlesArray = [];
            let numberOfParticles = (canvas.height * canvas.width) / 15000;
            for (let i = 0; i < numberOfParticles; i++) particlesArray.push(new Particle());
        }
        function animateParticles() {
            requestAnimationFrame(animateParticles);
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            for (let i = 0; i < particlesArray.length; i++) particlesArray[i].update();
            connectParticles();
        }
        function connectParticles() {
            for (let a = 0; a < particlesArray.length; a++) {
                for (let b = a; b < particlesArray.length; b++) {
                    let distance = ((particlesArray[a].x - particlesArray[b].x) ** 2) + ((particlesArray[a].y - particlesArray[b].y) ** 2);
                    if (distance < (canvas.width/9) * (canvas.height/9)) {
                        ctx.strokeStyle = 'rgba(212, 175, 55,' + (1 - distance/25000) * 0.15 + ')';
                        ctx.lineWidth = 1; ctx.beginPath(); ctx.moveTo(particlesArray[a].x, particlesArray[a].y); ctx.lineTo(particlesArray[b].x, particlesArray[b].y); ctx.stroke();
                    }
                }
            }
        }
        resizeCanvas(); animateParticles();

        // --- GALA LOGIC ---
        const SHEET_CSV_URL = "TU_ENLACE_CSV_AQUI"; 

        const categoriesList = [
            "Más tocapelotas del grupo",
            "Persona más graciosa del grupo",
            "Frase mítica del año",
            "Premio al más desaparecido",
            "Premio al que más come",
            "Fantasmada del año",
            "Pareja del año",
            "Mejor culo del grupo",
            "Plot twist del año",
            "Mejor foto del año",
            "Premio al más cagón",
            "Premio al que más bebe",
            "Momento más gracioso",
            "Mejor vídeo del año",
            "Mejor evento del año"
        ];

        const mediaMap = {
            "carlos": "fotos/carlos.jpg",
            "adriana": "fotos/adriana.jpg",
            "nicolas": "fotos/nicolas.jpg",
            "jose luis": "fotos/joseluis.jpg",
            "lucia": "fotos/lucia.jpg",
            "pablo dolz": "fotos/pablod.jpg",
            "pablo garcia": "fotos/pablog.jpg",
            "frase mítica": "fotos/frase_mitica.jpg",
            "fantasmada": "fotos/fantasmada.jpg",
            "pareja": "fotos/pareja_anio.jpg",
            "culo": "fotos/mejor_culo.jpg",
            "plot twist": "fotos/plot_twist.jpg",
            "foto del año": "fotos/foto_ganadora.jpg",
            "video del año": "fotos/video_ganador.mp4",
            "momento gracioso": "fotos/momento_gracioso.mp4",
            "mejor evento": "fotos/mejor_evento.jpg"
        };

        let winnersData = {};
        let currentIndex = 0;
        let isRevealing = false;
        let isRevealed = false;

        const audioDrum = document.getElementById('audio-drumroll');
        const audioVictory = document.getElementById('audio-victory');
        const cardInner = document.getElementById('main-card');
        const cardFront = document.getElementById('card-front');
        const titleEl = document.getElementById('category-title');
        const counterEl = document.getElementById('counter');
        const winnerNameEl = document.getElementById('winner-name');
        const imgEl = document.getElementById('winner-img');
        const videoEl = document.getElementById('winner-video');
        const btnNext = document.getElementById('btn-next');
        const btnPrev = document.getElementById('btn-prev');

        if(SHEET_CSV_URL === "TU_ENLACE_CSV_AQUI") { loadMockData(); } 
        else { loadMockData(); } 

        function loadMockData() {
            winnersData = {
                "Más tocapelotas del grupo": "Pablo Garcia",
                "Persona más graciosa del grupo": "Jose Luis",
                "Frase mítica del año": "Carlos",
                "Mejor vídeo del año": "video del año",
                "Mejor foto del año": "foto del año"
            };
            updateUI();
        }

        function updateUI() {
            isRevealed = false; isRevealing = false;
            cardInner.classList.remove('flipped');
            cardFront.classList.remove('animate-shake-hard');
            videoEl.pause(); audioDrum.pause(); audioVictory.pause();

            // Botones
            btnNext.classList.remove('opacity-100', 'pointer-events-auto', 'translate-y-0');
            btnNext.classList.add('opacity-0', 'pointer-events-none', 'translate-y-10');
            
            if (currentIndex === 0) {
                btnPrev.classList.remove('opacity-100', 'pointer-events-auto');
                btnPrev.classList.add('opacity-0', 'pointer-events-none');
            } else {
                btnPrev.classList.add('opacity-100', 'pointer-events-auto');
                btnPrev.classList.remove('opacity-0', 'pointer-events-none');
            }

            titleEl.innerHTML = categoriesList[currentIndex];
            titleEl.classList.remove('opacity-0', 'translate-y-[-20px]');
            counterEl.innerText = `${currentIndex + 1} / ${categoriesList.length}`;

            // Datos Ganador
            let currentCat = categoriesList[currentIndex];
            let winnerName = winnersData[currentCat] || "Ganador Pendiente";
            let mediaKey = winnerName.toLowerCase();
            
            if (!mediaMap[mediaKey]) {
                if (currentCat.includes("foto")) mediaKey = "foto del año";
                else if (currentCat.includes("vídeo")) mediaKey = "video del año";
                else mediaKey = "carlos"; 
            }

            const mediaPath = mediaMap[mediaKey] || "fotos/logo.png";
            winnerNameEl.innerText = winnerName;

            if (mediaPath.endsWith('.mp4')) {
                imgEl.classList.add('hidden');
                videoEl.classList.remove('hidden');
                videoEl.src = mediaPath;
            } else {
                videoEl.classList.add('hidden');
                imgEl.classList.remove('hidden');
                imgEl.src = mediaPath;
            }
        }

        function startRevealSequence() {
            if (isRevealed || isRevealing) return;
            isRevealing = true;
            audioDrum.currentTime = 0; audioDrum.volume = 1.0; audioDrum.play().catch(e => console.log(e));
            cardFront.classList.add('animate-shake-hard'); 
            setTimeout(() => { revealWinner(); }, 3500); 
        }

        function revealWinner() {
            cardFront.classList.remove('animate-shake-hard');
            audioDrum.pause();
            audioVictory.currentTime = 0; audioVictory.volume = 0.8; audioVictory.play();
            cardInner.classList.add('flipped');
            isRevealed = true;
            if (!videoEl.classList.contains('hidden')) videoEl.play();
            launchConfetti();
            setTimeout(() => {
                btnNext.classList.remove('opacity-0', 'pointer-events-none', 'translate-y-10');
                btnNext.classList.add('opacity-100', 'pointer-events-auto', 'translate-y-0');
            }, 1000);
        }

        function launchConfetti() {
            var duration = 4 * 1000; var animationEnd = Date.now() + duration; var defaults = { startVelocity: 45, spread: 360, ticks: 60, zIndex: 99999 };
            var interval = setInterval(function() {
                var timeLeft = animationEnd - Date.now();
                if (timeLeft <= 0) return clearInterval(interval);
                var particleCount = 100 * (timeLeft / duration);
                confetti(Object.assign({}, defaults, { particleCount, origin: { x: 0.5, y: 0.5 } }));
                confetti(Object.assign({}, defaults, { particleCount: particleCount * 0.5, colors: ['#d4af37', '#ffffff'], origin: { x: Math.random(), y: Math.random() - 0.2 } }));
            }, 250);
        }

        function changeCategory(dir) {
            const newIndex = currentIndex + dir;
            if (newIndex >= 0 && newIndex < categoriesList.length) {
                titleEl.classList.add('opacity-0', 'translate-y-[-20px]');
                setTimeout(() => { currentIndex = newIndex; updateUI(); }, 300);
            }
        }
    </script>
</body>
</html>